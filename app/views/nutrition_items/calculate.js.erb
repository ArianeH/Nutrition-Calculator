$('#result-partial').html("<%= escape_javascript(render partial: 'nutrition-calculation', locals: { selected: @selected, sum_selected: @sum_selected }) %>");

updateLinksWithNewSum()

function updateLinksWithNewSum() {

  var links = $('.calculate-link')

  for (index = 0; index < links.length; ++index) {
      link = links[index].firstElementChild 

      var hrefWithUpdatedSum = link.getAttribute('href').replace(new RegExp("sum_selected=[^\d]+"), "sum_calories=<%= @sum_selected%>")
      link.setAttribute("href", hrefWithUpdatedSum)
  }
}